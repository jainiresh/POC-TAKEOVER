"use strict";

const Rook = require('./interface');

function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

async function waitInitialized() {
  const singleton = require('./singleton');

  for (let i = 0; i < 10; i++) {
    if (singleton.singleton.augManager.initialized) {
      return true;
    }

    await sleep(200);
  }

  return false;
}

async function init() {
  const rookout = new Rook();
  await rookout.start();
  await waitInitialized();
}

module.exports = init;